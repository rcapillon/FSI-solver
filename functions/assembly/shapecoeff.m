function mat_coeffs = shapecoeff(nn)

% 3D shape function coefficients on the reference element (8-node or 20-node)

if nn == 8
    
    xref = [ 
            -1  , -1  , -1  ;
             1  , -1  , -1  ;
             1  ,  1  , -1  ;
            -1  ,  1  , -1  ;
            -1  , -1  ,  1  ;
             1  , -1  ,  1  ;
             1  ,  1  ,  1  ;
            -1  ,  1  ,  1  ;
           ] ;
        
    R =  [ 
          1,xref(1,1),xref(1,2),xref(1,3),...
            xref(1,1)*xref(1,2),xref(1,1)*xref(1,3),xref(1,2)*xref(1,3),...
            xref(1,1)*xref(1,2)*xref(1,3) ;
          1,xref(2,1),xref(2,2),xref(2,3),...
            xref(2,1)*xref(2,2),xref(2,1)*xref(2,3),xref(2,2)*xref(2,3),...
            xref(2,1)*xref(2,2)*xref(2,3) ;
          1,xref(3,1),xref(3,2),xref(3,3),...
            xref(3,1)*xref(3,2),xref(3,1)*xref(3,3),xref(3,2)*xref(3,3),...
            xref(3,1)*xref(3,2)*xref(3,3) ;
          1,xref(4,1),xref(4,2),xref(4,3),...
            xref(4,1)*xref(4,2),xref(4,1)*xref(4,3),xref(4,2)*xref(4,3),...
            xref(4,1)*xref(4,2)*xref(4,3) ;
          1,xref(5,1),xref(5,2),xref(5,3),...
            xref(5,1)*xref(5,2),xref(5,1)*xref(5,3),xref(5,2)*xref(5,3),...
            xref(5,1)*xref(5,2)*xref(5,3) ;
          1,xref(6,1),xref(6,2),xref(6,3),...
            xref(6,1)*xref(6,2),xref(6,1)*xref(6,3),xref(6,2)*xref(6,3),...
            xref(6,1)*xref(6,2)*xref(6,3) ;
          1,xref(7,1),xref(7,2),xref(7,3),...
            xref(7,1)*xref(7,2),xref(7,1)*xref(7,3),xref(7,2)*xref(7,3),...
            xref(7,1)*xref(7,2)*xref(7,3) ;
          1,xref(8,1),xref(8,2),xref(8,3),...
            xref(8,1)*xref(8,2),xref(8,1)*xref(8,3),xref(8,2)*xref(8,3),...
            xref(8,1)*xref(8,2)*xref(8,3) ;
         ] ;
    
    
    Id8 = eye(8,8) ;
    
    mat_coeffs = R \ Id8 ;
        
end

if nn == 20
    
    xref = [ 
            -1  , -1  , -1  ;
             1  , -1  , -1  ;
             1  ,  1  , -1  ;
            -1  ,  1  , -1  ;
            -1  , -1  ,  1  ;
             1  , -1  ,  1  ;
             1  ,  1  ,  1  ;
            -1  ,  1  ,  1  ;
             0  , -1  , -1  ;
             1  ,  0  , -1  ;
             0  ,  1  , -1  ;
            -1  ,  0  , -1  ;
            -1  , -1  ,  0  ;
             1  , -1  ,  0  ;
             1  ,  1  ,  0  ;
            -1  ,  1  ,  0  ;
             0  , -1  ,  1  ;
             1  ,  0  ,  1  ;
             0  ,  1  ,  1  ;
            -1  ,  0  ,  1
           ] ;
    
    
    R = [ 1,xref(1,1),xref(1,2),xref(1,3),...
        xref(1,1)*xref(1,2),xref(1,1)*xref(1,3),xref(1,2)*xref(1,3),xref(1,1)*xref(1,2)*xref(1,3),...
        xref(1,1)^2,xref(1,2)^2,xref(1,3)^2,xref(1,2)*xref(1,1)^2,xref(1,3)*xref(1,1)^2,...
        xref(1,1)*xref(1,2)^2,xref(1,3)*xref(1,2)^2,xref(1,1)*xref(1,3)^2,xref(1,2)*xref(1,3)^2,...
        xref(1,2)*xref(1,3)*xref(1,1)^2,...
        xref(1,1)*xref(1,3)*xref(1,2)^2,xref(1,1)*xref(1,2)*xref(1,3)^2 ;
        1,xref(2,1),xref(2,2),xref(2,3),...
        xref(2,1)*xref(2,2),xref(2,1)*xref(2,3),xref(2,2)*xref(2,3),xref(2,1)*xref(2,2)*xref(2,3),...
        xref(2,1)^2,xref(2,2)^2,xref(2,3)^2,xref(2,2)*xref(2,1)^2,xref(2,3)*xref(2,1)^2,...
        xref(2,1)*xref(2,2)^2,xref(2,3)*xref(2,2)^2,xref(2,1)*xref(2,3)^2,xref(2,2)*xref(2,3)^2,...
        xref(2,2)*xref(2,3)*xref(2,1)^2,...
        xref(2,1)*xref(2,3)*xref(2,2)^2,xref(2,1)*xref(2,2)*xref(2,3)^2 ;
        1,xref(3,1),xref(3,2),xref(3,3),...
        xref(3,1)*xref(3,2),xref(3,1)*xref(3,3),xref(3,2)*xref(3,3),xref(3,1)*xref(3,2)*xref(3,3),...
        xref(3,1)^2,xref(3,2)^2,xref(3,3)^2,xref(3,2)*xref(3,1)^2,xref(3,3)*xref(3,1)^2,...
        xref(3,1)*xref(3,2)^2,xref(3,3)*xref(3,2)^2,xref(3,1)*xref(3,3)^2,xref(3,2)*xref(3,3)^2,...
        xref(3,2)*xref(3,3)*xref(3,1)^2,...
        xref(3,1)*xref(3,3)*xref(3,2)^2,xref(3,1)*xref(3,2)*xref(3,3)^2 ;
        1,xref(4,1),xref(4,2),xref(4,3),...
        xref(4,1)*xref(4,2),xref(4,1)*xref(4,3),xref(4,2)*xref(4,3),xref(4,1)*xref(4,2)*xref(4,3),...
        xref(4,1)^2,xref(4,2)^2,xref(4,3)^2,xref(4,2)*xref(4,1)^2,xref(4,3)*xref(4,1)^2,...
        xref(4,1)*xref(4,2)^2,xref(4,3)*xref(4,2)^2,xref(4,1)*xref(4,3)^2,xref(4,2)*xref(4,3)^2,...
        xref(4,2)*xref(4,3)*xref(4,1)^2,...
        xref(4,1)*xref(4,3)*xref(4,2)^2,xref(4,1)*xref(4,2)*xref(4,3)^2 ;
        1,xref(5,1),xref(5,2),xref(5,3),...
        xref(5,1)*xref(5,2),xref(5,1)*xref(5,3),xref(5,2)*xref(5,3),xref(5,1)*xref(5,2)*xref(5,3),...
        xref(5,1)^2,xref(5,2)^2,xref(5,3)^2,xref(5,2)*xref(5,1)^2,xref(5,3)*xref(5,1)^2,...
        xref(5,1)*xref(5,2)^2,xref(5,3)*xref(5,2)^2,xref(5,1)*xref(5,3)^2,xref(5,2)*xref(5,3)^2,...
        xref(5,2)*xref(5,3)*xref(5,1)^2,...
        xref(5,1)*xref(5,3)*xref(5,2)^2,xref(5,1)*xref(5,2)*xref(5,3)^2 ;
        1,xref(6,1),xref(6,2),xref(6,3),...
        xref(6,1)*xref(6,2),xref(6,1)*xref(6,3),xref(6,2)*xref(6,3),xref(6,1)*xref(6,2)*xref(6,3),...
        xref(6,1)^2,xref(6,2)^2,xref(6,3)^2,xref(6,2)*xref(6,1)^2,xref(6,3)*xref(6,1)^2,...
        xref(6,1)*xref(6,2)^2,xref(6,3)*xref(6,2)^2,xref(6,1)*xref(6,3)^2,xref(6,2)*xref(6,3)^2,...
        xref(6,2)*xref(6,3)*xref(6,1)^2,...
        xref(6,1)*xref(6,3)*xref(6,2)^2,xref(6,1)*xref(6,2)*xref(6,3)^2 ;
        1,xref(7,1),xref(7,2),xref(7,3),...
        xref(7,1)*xref(7,2),xref(7,1)*xref(7,3),xref(7,2)*xref(7,3),xref(7,1)*xref(7,2)*xref(7,3),...
        xref(7,1)^2,xref(7,2)^2,xref(7,3)^2,xref(7,2)*xref(7,1)^2,xref(7,3)*xref(7,1)^2,...
        xref(7,1)*xref(7,2)^2,xref(7,3)*xref(7,2)^2,xref(7,1)*xref(7,3)^2,xref(7,2)*xref(7,3)^2,...
        xref(7,2)*xref(7,3)*xref(7,1)^2,...
        xref(7,1)*xref(7,3)*xref(7,2)^2,xref(7,1)*xref(7,2)*xref(7,3)^2 ;
        1,xref(8,1),xref(8,2),xref(8,3),...
        xref(8,1)*xref(8,2),xref(8,1)*xref(8,3),xref(8,2)*xref(8,3),xref(8,1)*xref(8,2)*xref(8,3),...
        xref(8,1)^2,xref(8,2)^2,xref(8,3)^2,xref(8,2)*xref(8,1)^2,xref(8,3)*xref(8,1)^2,...
        xref(8,1)*xref(8,2)^2,xref(8,3)*xref(8,2)^2,xref(8,1)*xref(8,3)^2,xref(8,2)*xref(8,3)^2,...
        xref(8,2)*xref(8,3)*xref(8,1)^2,...
        xref(8,1)*xref(8,3)*xref(8,2)^2,xref(8,1)*xref(8,2)*xref(8,3)^2 ;
        1,xref(9,1),xref(9,2),xref(9,3),...
        xref(9,1)*xref(9,2),xref(9,1)*xref(9,3),xref(9,2)*xref(9,3),xref(9,1)*xref(9,2)*xref(9,3),...
        xref(9,1)^2,xref(9,2)^2,xref(9,3)^2,xref(9,2)*xref(9,1)^2,xref(9,3)*xref(9,1)^2,...
        xref(9,1)*xref(9,2)^2,xref(9,3)*xref(9,2)^2,xref(9,1)*xref(9,3)^2,xref(9,2)*xref(9,3)^2,...
        xref(9,2)*xref(9,3)*xref(9,1)^2,...
        xref(9,1)*xref(9,3)*xref(9,2)^2,xref(9,1)*xref(9,2)*xref(9,3)^2 ;
        1,xref(10,1),xref(10,2),xref(10,3),...
        xref(10,1)*xref(10,2),xref(10,1)*xref(10,3),xref(10,2)*xref(10,3),xref(10,1)*xref(10,2)*xref(10,3),...
        xref(10,1)^2,xref(10,2)^2,xref(10,3)^2,xref(10,2)*xref(10,1)^2,xref(10,3)*xref(10,1)^2,...
        xref(10,1)*xref(10,2)^2,xref(10,3)*xref(10,2)^2,xref(10,1)*xref(10,3)^2,xref(10,2)*xref(10,3)^2,...
        xref(10,2)*xref(10,3)*xref(10,1)^2,...
        xref(10,1)*xref(10,3)*xref(10,2)^2,xref(10,1)*xref(10,2)*xref(10,3)^2 ;
        1,xref(11,1),xref(11,2),xref(11,3),...
        xref(11,1)*xref(11,2),xref(11,1)*xref(11,3),xref(11,2)*xref(11,3),xref(11,1)*xref(11,2)*xref(11,3),...
        xref(11,1)^2,xref(11,2)^2,xref(11,3)^2,xref(11,2)*xref(11,1)^2,xref(11,3)*xref(11,1)^2,...
        xref(11,1)*xref(11,2)^2,xref(11,3)*xref(11,2)^2,xref(11,1)*xref(11,3)^2,xref(11,2)*xref(11,3)^2,...
        xref(11,2)*xref(11,3)*xref(11,1)^2,...
        xref(11,1)*xref(11,3)*xref(11,2)^2,xref(11,1)*xref(11,2)*xref(11,3)^2 ;
        1,xref(12,1),xref(12,2),xref(12,3),...
        xref(12,1)*xref(12,2),xref(12,1)*xref(12,3),xref(12,2)*xref(12,3),xref(12,1)*xref(12,2)*xref(12,3),...
        xref(12,1)^2,xref(12,2)^2,xref(12,3)^2,xref(12,2)*xref(12,1)^2,xref(12,3)*xref(12,1)^2,...
        xref(12,1)*xref(12,2)^2,xref(12,3)*xref(12,2)^2,xref(12,1)*xref(12,3)^2,xref(12,2)*xref(12,3)^2,...
        xref(12,2)*xref(12,3)*xref(12,1)^2,...
        xref(12,1)*xref(12,3)*xref(12,2)^2,xref(12,1)*xref(12,2)*xref(12,3)^2 ;
        1,xref(13,1),xref(13,2),xref(13,3),...
        xref(13,1)*xref(13,2),xref(13,1)*xref(13,3),xref(13,2)*xref(13,3),xref(13,1)*xref(13,2)*xref(13,3),...
        xref(13,1)^2,xref(13,2)^2,xref(13,3)^2,xref(13,2)*xref(13,1)^2,xref(13,3)*xref(13,1)^2,...
        xref(13,1)*xref(13,2)^2,xref(13,3)*xref(13,2)^2,xref(13,1)*xref(13,3)^2,xref(13,2)*xref(13,3)^2,...
        xref(13,2)*xref(13,3)*xref(13,1)^2,...
        xref(13,1)*xref(13,3)*xref(13,2)^2,xref(13,1)*xref(13,2)*xref(13,3)^2 ;
        1,xref(14,1),xref(14,2),xref(14,3),...
        xref(14,1)*xref(14,2),xref(14,1)*xref(14,3),xref(14,2)*xref(14,3),xref(14,1)*xref(14,2)*xref(14,3),...
        xref(14,1)^2,xref(14,2)^2,xref(14,3)^2,xref(14,2)*xref(14,1)^2,xref(14,3)*xref(14,1)^2,...
        xref(14,1)*xref(14,2)^2,xref(14,3)*xref(14,2)^2,xref(14,1)*xref(14,3)^2,xref(14,2)*xref(14,3)^2,...
        xref(14,2)*xref(14,3)*xref(14,1)^2,...
        xref(14,1)*xref(14,3)*xref(14,2)^2,xref(14,1)*xref(14,2)*xref(14,3)^2 ;
        1,xref(15,1),xref(15,2),xref(15,3),...
        xref(15,1)*xref(15,2),xref(15,1)*xref(15,3),xref(15,2)*xref(15,3),xref(15,1)*xref(15,2)*xref(15,3),...
        xref(15,1)^2,xref(15,2)^2,xref(15,3)^2,xref(15,2)*xref(15,1)^2,xref(15,3)*xref(15,1)^2,...
        xref(15,1)*xref(15,2)^2,xref(15,3)*xref(15,2)^2,xref(15,1)*xref(15,3)^2,xref(15,2)*xref(15,3)^2,...
        xref(15,2)*xref(15,3)*xref(15,1)^2,...
        xref(15,1)*xref(15,3)*xref(15,2)^2,xref(15,1)*xref(15,2)*xref(15,3)^2 ;
        1,xref(16,1),xref(16,2),xref(16,3),...
        xref(16,1)*xref(16,2),xref(16,1)*xref(16,3),xref(16,2)*xref(16,3),xref(16,1)*xref(16,2)*xref(16,3),...
        xref(16,1)^2,xref(16,2)^2,xref(16,3)^2,xref(16,2)*xref(16,1)^2,xref(16,3)*xref(16,1)^2,...
        xref(16,1)*xref(16,2)^2,xref(16,3)*xref(16,2)^2,xref(16,1)*xref(16,3)^2,xref(16,2)*xref(16,3)^2,...
        xref(16,2)*xref(16,3)*xref(16,1)^2,...
        xref(16,1)*xref(16,3)*xref(16,2)^2,xref(16,1)*xref(16,2)*xref(16,3)^2 ;
        1,xref(17,1),xref(17,2),xref(17,3),...
        xref(17,1)*xref(17,2),xref(17,1)*xref(17,3),xref(17,2)*xref(17,3),xref(17,1)*xref(17,2)*xref(17,3),...
        xref(17,1)^2,xref(17,2)^2,xref(17,3)^2,xref(17,2)*xref(17,1)^2,xref(17,3)*xref(17,1)^2,...
        xref(17,1)*xref(17,2)^2,xref(17,3)*xref(17,2)^2,xref(17,1)*xref(17,3)^2,xref(17,2)*xref(17,3)^2,...
        xref(17,2)*xref(17,3)*xref(17,1)^2,...
        xref(17,1)*xref(17,3)*xref(17,2)^2,xref(17,1)*xref(17,2)*xref(17,3)^2 ;
        1,xref(18,1),xref(18,2),xref(18,3),...
        xref(18,1)*xref(18,2),xref(18,1)*xref(18,3),xref(18,2)*xref(18,3),xref(18,1)*xref(18,2)*xref(18,3),...
        xref(18,1)^2,xref(18,2)^2,xref(18,3)^2,xref(18,2)*xref(18,1)^2,xref(18,3)*xref(18,1)^2,...
        xref(18,1)*xref(18,2)^2,xref(18,3)*xref(18,2)^2,xref(18,1)*xref(18,3)^2,xref(18,2)*xref(18,3)^2,...
        xref(18,2)*xref(18,3)*xref(18,1)^2,...
        xref(18,1)*xref(18,3)*xref(18,2)^2,xref(18,1)*xref(18,2)*xref(18,3)^2 ;
        1,xref(19,1),xref(19,2),xref(19,3),...
        xref(19,1)*xref(19,2),xref(19,1)*xref(19,3),xref(19,2)*xref(19,3),xref(19,1)*xref(19,2)*xref(19,3),...
        xref(19,1)^2,xref(19,2)^2,xref(19,3)^2,xref(19,2)*xref(19,1)^2,xref(19,3)*xref(19,1)^2,...
        xref(19,1)*xref(19,2)^2,xref(19,3)*xref(19,2)^2,xref(19,1)*xref(19,3)^2,xref(19,2)*xref(19,3)^2,...
        xref(19,2)*xref(19,3)*xref(19,1)^2,...
        xref(19,1)*xref(19,3)*xref(19,2)^2,xref(19,1)*xref(19,2)*xref(19,3)^2 ;
        1,xref(20,1),xref(20,2),xref(20,3),...
        xref(20,1)*xref(20,2),xref(20,1)*xref(20,3),xref(20,2)*xref(20,3),xref(20,1)*xref(20,2)*xref(20,3),...
        xref(20,1)^2,xref(20,2)^2,xref(20,3)^2,xref(20,2)*xref(20,1)^2,xref(20,3)*xref(20,1)^2,...
        xref(20,1)*xref(20,2)^2,xref(20,3)*xref(20,2)^2,xref(20,1)*xref(20,3)^2,xref(20,2)*xref(20,3)^2,...
        xref(20,2)*xref(20,3)*xref(20,1)^2,...
        xref(20,1)*xref(20,3)*xref(20,2)^2,xref(20,1)*xref(20,2)*xref(20,3)^2                                 ] ;
    
    
    Id20 = eye(20,20) ;
    
    mat_coeffs = R \ Id20 ;
    
end